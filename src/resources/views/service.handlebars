<!-- Font Awesome để có icon giống ảnh -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<div class="container my-5">
  <h4 class="mb-4 fw-bold">Các tiện nghi được ưa chuộng nhất</h4>

  <!-- Icons hàng đầu -->
  <div class="mb-3 d-flex flex-wrap gap-3">
    <span><i class="fas fa-wifi text-success me-1"></i>Wi-Fi miễn phí</span>
    <span><i class="fas fa-shuttle-van text-success me-1"></i>Xe đưa đón sân bay</span>
    <span><i class="fas fa-users text-success me-1"></i>Phòng gia đình</span>
    <span><i class="fas fa-smoking-ban text-success me-1"></i>Phòng không hút thuốc</span>
    <span><i class="fas fa-utensils text-success me-1"></i>Nhà hàng</span>
    <span><i class="fas fa-parking text-success me-1"></i>Chỗ đỗ xe miễn phí</span>
    <span><i class="fas fa-bell text-success me-1"></i>Dịch vụ phòng</span>
  </div>

  <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3">
    <!-- Cột 1 -->
    <div class="col mb-4">
      <h6 class="fw-bold">Cực kỳ phù hợp cho kỳ lưu trú của bạn</h6>
      <ul class="list-unstyled small">
        <li>✔ Phòng tắm riêng</li>
        <li>✔ Chỗ đỗ xe miễn phí</li>
        <li>✔ Điều hòa không khí</li>
        <li>✔ Bãi biển</li>
        <li>✔ WiFi miễn phí</li>
        <li>✔ TV màn hình phẳng</li>
        <li>✔ Phòng gia đình</li>
        <li>✔ Xe đưa đón sân bay</li>
        <li>✔ Phòng không hút thuốc</li>
      </ul>

      <h6 class="fw-bold mt-3">Phòng tắm</h6>
      <ul class="list-unstyled small">
        <li>✔ Giấy vệ sinh, Khăn tắm</li>
        <li>✔ Bồn tắm hoặc vòi sen</li>
        <li>✔ Dép, Máy sấy tóc</li>
        <li>✔ Phòng tắm riêng</li>
      </ul>
    </div>

    <!-- Cột 2 -->
    <div class="col mb-4">
      <h6 class="fw-bold">Tiện ích trong phòng</h6>
      <ul class="list-unstyled small">
        <li>✔ Ổ điện gần giường</li>
        <li>✔ Giá treo quần áo</li>
      </ul>

      <h6 class="fw-bold mt-3">Hoạt động & Công nghệ</h6>
      <ul class="list-unstyled small">
        <li>✔ Bãi biển</li>
        <li>✔ TV màn hình phẳng</li>
      </ul>

      <h6 class="fw-bold mt-3">Internet & Đồ ăn</h6>
      <ul class="list-unstyled small">
        <li>✔ Wi-Fi miễn phí toàn khách sạn</li>
        <li>✔ Nhà hàng</li>
      </ul>

      <h6 class="fw-bold mt-3">Chỗ đậu xe</h6>
      <ul class="list-unstyled small">
        <li>✔ Có chỗ đỗ xe miễn phí (không cần đặt trước)</li>
      </ul>
    </div>

    <!-- Cột 3 -->
    <div class="col mb-4">
      <h6 class="fw-bold">Dịch vụ</h6>
      <ul class="list-unstyled small">
        <li>✔ Dọn phòng hàng ngày</li>
        <li>✔ Giặt ủi, Là (ủi) – <em>Phụ phí</em></li>
        <li>✔ Fax/Photocopy – <em>Phụ phí</em></li>
        <li>✔ Xe đưa đón – <em>Phụ phí</em></li>
        <li>✔ Lễ tân 24/7</li>
        <li>✔ Dịch vụ phòng</li>
      </ul>

      <h6 class="fw-bold mt-3">An ninh</h6>
      <ul class="list-unstyled small">
        <li>✔ Bình chữa cháy, Camera khu vực chung</li>
        <li>✔ Thiết bị báo cháy, Khóa thẻ từ</li>
        <li>✔ Bảo vệ 24/7</li>
      </ul>

      <h6 class="fw-bold mt-3">Khác</h6>
      <ul class="list-unstyled small">
        <li>✔ Thang máy, Sàn lát đá</li>
        <li>✔ Phòng cách âm, Điều hòa</li>
        <li>✔ Lối vào cho người khuyết tật</li>
        <li>✔ Tiếng Việt, Tiếng Anh</li>
      </ul>
    </div>
  </div>
</div>
<!-- Quy tắc chung -->
<div class="container my-5">
  <h4 class="fw-bold mb-4">Quy tắc chung</h4>
  <p class="text-muted mb-4">Khách sạn của chúng tôi nhận yêu cầu đặc biệt - vui lòng ghi trong bước tiếp theo!</p>

  <div class="border rounded p-3 bg-light">

    <div class="mb-3 d-flex">
      <i class="fas fa-sign-in-alt fa-lg text-primary me-3 mt-1"></i>
      <div>
        <strong>Nhận phòng</strong><br>
        Từ 14:00 - 17:00
      </div>
    </div>

    <div class="mb-3 d-flex">
      <i class="fas fa-sign-out-alt fa-lg text-primary me-3 mt-1"></i>
      <div>
        <strong>Trả phòng</strong><br>
        Từ 10:00 - 12:00
      </div>
    </div>

    <div class="mb-3 d-flex">
      <i class="fas fa-info-circle fa-lg text-primary me-3 mt-1"></i>
      <div>
        <strong>Hủy đặt phòng/ Trả trước</strong><br>
        Các chính sách huỷ và thanh toán trước sẽ khác nhau tùy vào loại phòng. Vui lòng nhập ngày lưu trú và xem điều kiện áp dụng cho phòng bạn chọn.
      </div>
    </div>

    <div class="mb-3 d-flex">
      <i class="fas fa-clock fa-lg text-primary me-3 mt-1"></i>
      <div>
        <strong>Giờ giới nghiêm</strong><br>
        Cổng vào chỗ nghỉ sẽ đóng trong khoảng từ 23:00 - 07:00
      </div>
    </div>

    

    <div class="mb-3 d-flex">
      <i class="fas fa-user-check fa-lg text-primary me-3 mt-1"></i>
      <div>
        <strong> giới hạn độ tuổi từ 18+ </strong><br>
        Không có yêu cầu về độ tuổi khi nhận phòng
      </div>
    </div>

    <div class="mb-3 d-flex">
      <i class="fas fa-dog fa-lg text-primary me-3 mt-1"></i>
      <div>
        <strong>Vật nuôi</strong><br>
        Vật nuôi không được phép.
      </div>
    </div>

    <div class="mb-2 d-flex">
      <i class="fas fa-credit-card fa-lg text-primary me-3 mt-1"></i>
      <div>
        <strong>Các phương thức thanh toán được chấp nhận</strong><br>
        <img src="https://img.icons8.com/color/48/000000/visa.png" width="40" />
        <img src="https://img.icons8.com/color/48/000000/mastercard.png" width="40" />
        <img src="https://img.icons8.com/color/48/000000/jcb.png" width="40" />
        <img src="https://img.icons8.com/color/48/000000/cash-in-hand.png" width="40" />
      </div>
    </div>

  </div>
</div>
<!-- Đánh giá khách hàng -->
<div class="container my-5" id="feedback-section">
  <h4 class="fw-bold mb-4">Đánh giá của khách hàng</h4>
  <div class="mb-3" id="average-rating">Đang tính điểm trung bình...</div>

  <div id="feedback-list"></div>

  <button id="toggle-feedback-btn" class="btn btn-outline-primary mt-3">Xem thêm đánh giá</button>

  <hr class="my-4" />

  <h5 class="mb-3">Gửi đánh giá của bạn</h5>
  <form id="feedback-form">
    <div class="star-rating">
      <input type="radio" name="rating" value="5" id="star5"><label for="star5">★</label>
      <input type="radio" name="rating" value="4" id="star4"><label for="star4">★</label>
      <input type="radio" name="rating" value="3" id="star3"><label for="star3">★</label>
      <input type="radio" name="rating" value="2" id="star2"><label for="star2">★</label>
      <input type="radio" name="rating" value="1" id="star1"><label for="star1">★</label>
  </div>
    <div class="mb-3">
      <textarea class="form-control" id="comment" placeholder="Viết đánh giá..." rows="3" required></textarea>
    </div>
    <button type="submit" class="btn btn-success">Gửi đánh giá</button>
  </form>
</div>
<style>
.star-rating {
  direction: rtl; /* Đảo chiều để chọn từ phải sang trái */
  display: inline-flex;
}
.star-rating input {
  display: none;
}
.star-rating label {
  font-size: 30px;
  color: #ccc;
  cursor: pointer;
  transition: color 0.2s;
}
.star-rating input:checked ~ label,
.star-rating label:hover,
.star-rating label:hover ~ label {
  color: #FFD700;
}
#feedback-list {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 20px;
}

.feedback-card {
  background-color: #fff;
  min-height: 180px;
}
@media (max-width: 992px) {
  #feedback-list {
    grid-template-columns: repeat(2, 1fr);
  }
}
@media (max-width: 576px) {
  #feedback-list {
    grid-template-columns: 1fr;
  }
}

</style>
<script>
document.addEventListener("DOMContentLoaded", function () {
  const listEl = document.getElementById("feedback-list");
  const avgEl = document.getElementById("average-rating");
  const btn = document.getElementById("toggle-feedback-btn");
  let fullList = [];
  let showingAll = false;

  function renderFeedbacks(list) {
    listEl.innerHTML = "";
    list.forEach(fb => {
      const div = document.createElement("div");
      div.className = "feedback-card p-3 border rounded shadow-sm";
      div.innerHTML = `
        <div class="mb-2"><strong>${fb.user?.name || "Khách"}</strong> – ${new Date(fb.createdAt).toLocaleDateString()}</div>
        <div class="text-warning mb-2">⭐ ${fb.rating}/5</div>
        <div class="mb-2">${fb.comment}</div>
        ${fb.reply ? `<div class="border-top pt-2 mt-2"><strong>Phản hồi:</strong> ${fb.reply}</div>` : ''}
      `;

      listEl.appendChild(div);
    });
  }

  function updateAverage(list) {
    if (list.length === 0) {
      avgEl.innerText = "Chưa có đánh giá nào.";
      return;
    }
    const avg = (list.reduce((sum, r) => sum + r.rating, 0) / list.length).toFixed(1);
    avgEl.innerText = `★ Trung bình: ${avg}/5 từ ${list.length} đánh giá`;
  }

  function loadFeedbacks() {
    fetch("/feedbacks")
      .then(res => res.json())
      .then(data => {
        fullList = data.reverse(); // mới nhất lên đầu
        updateAverage(fullList);
        renderFeedbacks(fullList.slice(0, 3));
      });
  }

  btn.addEventListener("click", () => {
    if (!showingAll) {
      renderFeedbacks(fullList);
      btn.innerText = "Ẩn bớt đánh giá";
    } else {
      renderFeedbacks(fullList.slice(0, 3));
      btn.innerText = "Xem thêm đánh giá";
    }
    showingAll = !showingAll;
  });

  document.getElementById("feedback-form").addEventListener("submit", function (e) {
    e.preventDefault();
    const selectedRating = document.querySelector('input[name="rating"]:checked');
    const rating = selectedRating ? parseFloat(selectedRating.value) : NaN;

    const comment = document.getElementById("comment").value.trim();

    if (isNaN(rating) || rating < 1 || rating > 5 || !comment) {
      alert("Vui lòng nhập đầy đủ và hợp lệ.");
      return;
    }

    fetch("/feedbacks", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ comment, rating })
    })
    .then(res => {
      if (!res.ok) throw new Error();
      return res.json();
    })
    .then(() => {
      alert("Cảm ơn bạn đã gửi đánh giá!");
      document.getElementById("feedback-form").reset();
      loadFeedbacks();
    })
    .catch(() => alert("Lỗi gửi đánh giá."));
  });

  loadFeedbacks();
});
</script>
